<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Client SDK - Mitosis Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="Mitosis is a Rust library and a command line tool to run distributed platforms for transport research.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="../guide/installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../guide/coordinator.html"><strong aria-hidden="true">2.</strong> Running a Coordinator</a></li><li class="chapter-item expanded "><a href="../guide/worker.html"><strong aria-hidden="true">3.</strong> Running a Worker</a></li><li class="chapter-item expanded "><a href="../guide/client.html"><strong aria-hidden="true">4.</strong> Running a Client</a></li><li class="chapter-item expanded "><a href="../guide/manager.html"><strong aria-hidden="true">5.</strong> Managing multiple Workers</a></li><li class="chapter-item expanded "><a href="../guide/architecture.html"><strong aria-hidden="true">6.</strong> Architecture Overview</a></li><li class="chapter-item expanded "><a href="../guide/troubleshooting.html"><strong aria-hidden="true">7.</strong> Troubleshooting</a></li><li class="chapter-item expanded affix "><li class="part-title">Developer Guide</li><li class="chapter-item expanded "><a href="../guide/development.html"><strong aria-hidden="true">8.</strong> Development Setup</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference Guide</li><li class="chapter-item expanded "><a href="../client/sdk.html" class="active"><strong aria-hidden="true">9.</strong> Client SDK</a></li><li class="chapter-item expanded "><a href="../http/index.html"><strong aria-hidden="true">10.</strong> HTTP endpoints</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Mitosis Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/stack-rs/mitosis/tree/master/guide" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/stack-rs/mitosis/edit/master/guide/src/client/sdk.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="client-sdk"><a class="header" href="#client-sdk">Client SDK</a></h1>
<p>The Mitosis project contains a SDK library (named <code>netmito</code>) that you can use to create your own client applications programmatically. The SDK provides a comprehensive Rust API for interacting with Mitosis coordinators.
For Python SDK, please refer to the <a href="https://github.com/stack-rs/mitosis-python-sdk">Mitosis Python SDK repository</a>.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Add the following to your <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[dependencies]
netmito = "0.6.0"
tokio = { version = "1.0", features = ["full"] }
uuid = { version = "1.18", features = ["v4"] }
</code></pre>
<h2 id="basic-usage"><a class="header" href="#basic-usage">Basic Usage</a></h2>
<h3 id="client-setup"><a class="header" href="#client-setup">Client Setup</a></h3>
<pre><code class="language-rust ignore">use netmito::client::MitoClient;
use netmito::config::{ClientConfig, client::LoginArgs};

#[tokio::main]
async fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    // Create client configuration
    let mut config = ClientConfig::default();
    config.coordinator_addr = "http://localhost:5000".parse()?;

    // Create client instance
    let mut client = MitoClient::setup(config).await?;

    // Login with credentials
    let login_args = LoginArgs {
        username: Some("username".to_string()),
        password: Some("password".to_string()),
        retain: true,
    };
    client.user_login(login_args).await?;

    Ok(())
}</code></pre>
<h3 id="task-management"><a class="header" href="#task-management">Task Management</a></h3>
<h4 id="submitting-tasks"><a class="header" href="#submitting-tasks">Submitting Tasks</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::TaskSubmitArgs;

// Submit a simple task
let args = TaskSubmitArgs {
    command: vec!["echo".to_string(), "Hello World".to_string()],
    group: Some("my-group".to_string()),
    tags: vec!["test".to_string()],
    labels: vec!["example".to_string()],
    env: vec!["MY_VAR=value".to_string()],
    terminal: true, // Capture stdout/stderr
    ..Default::default()
};

let task_id = client.task_submit(args).await?;
println!("Submitted task: {}", task_id);</code></pre>
<h4 id="querying-tasks"><a class="header" href="#querying-tasks">Querying Tasks</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::TaskQueryArgs;

// Query all tasks
let args = TaskQueryArgs::default();
let tasks = client.task_query(args).await?;

// Query tasks with filters
let args = TaskQueryArgs {
    labels: Some(vec!["example".to_string()]),
    status: Some("completed".to_string()),
    limit: Some(10),
    ..Default::default()
};
let filtered_tasks = client.task_query(args).await?;</code></pre>
<h4 id="getting-task-details"><a class="header" href="#getting-task-details">Getting Task Details</a></h4>
<pre><code class="language-rust ignore">use uuid::Uuid;

let task_id = Uuid::parse_str("550e8400-e29b-41d4-a716-446655440000")?;
let task_info = client.task_get(task_id).await?;

println!("Task status: {:?}", task_info.exec_state);
println!("Created at: {}", task_info.created_at);</code></pre>
<h4 id="downloading-artifacts"><a class="header" href="#downloading-artifacts">Downloading Artifacts</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::TaskArtifactDownloadArgs;

let args = TaskArtifactDownloadArgs {
    task_id,
    artifact_type: "result".to_string(), // "result", "exec-log", or "std-log"
    output_path: Some("./task-results.tar.gz".to_string()),
    ..Default::default()
};

client.task_artifact_download(args).await?;</code></pre>
<h3 id="user-and-group-management"><a class="header" href="#user-and-group-management">User and Group Management</a></h3>
<h4 id="creating-users-admin-only"><a class="header" href="#creating-users-admin-only">Creating Users (Admin only)</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::AdminCreateUserArgs;

let args = AdminCreateUserArgs {
    username: Some("new_user".to_string()),
    password: Some("secure_password".to_string()),
    admin: false,
};

client.admin_create_user(args).await?;</code></pre>
<h4 id="group-operations"><a class="header" href="#group-operations">Group Operations</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::{GroupCreateArgs, GroupUpdateUserArgs};

// Create a group
let args = GroupCreateArgs {
    group_name: "research-team".to_string(),
};
client.group_create(args).await?;

// Add user to group
let args = GroupUpdateUserArgs {
    group_name: "research-team".to_string(),
    username: "researcher".to_string(),
    role: "write".to_string(), // "read", "write", or "admin"
};
client.group_update_user(args).await?;</code></pre>
<h3 id="worker-management"><a class="header" href="#worker-management">Worker Management</a></h3>
<h4 id="querying-workers"><a class="header" href="#querying-workers">Querying Workers</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::WorkerQueryArgs;

let args = WorkerQueryArgs {
    group: Some("my-group".to_string()),
    tags: Some(vec!["gpu".to_string()]),
    ..Default::default()
};

let workers = client.worker_query(args).await?;
for worker in workers {
    println!("Worker {} is {}", worker.id, worker.status);
}</code></pre>
<h4 id="managing-worker-tags"><a class="header" href="#managing-worker-tags">Managing Worker Tags</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::WorkerUpdateTagsArgs;

let worker_id = Uuid::parse_str("worker-uuid-here")?;
let args = WorkerUpdateTagsArgs {
    worker_id,
    tags: vec!["gpu".to_string(), "cuda".to_string()],
};

client.worker_update_tags(args).await?;</code></pre>
<h3 id="group-attachments"><a class="header" href="#group-attachments">Group Attachments</a></h3>
<h4 id="uploading-files"><a class="header" href="#uploading-files">Uploading Files</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::GroupAttachmentUploadArgs;

let args = GroupAttachmentUploadArgs {
    group_name: Some("my-group".to_string()),
    local_path: "./dataset.tar.gz".to_string(),
    attachment_key: Some("datasets/experiment-1.tar.gz".to_string()),
    ..Default::default()
};

client.group_attachment_upload(args).await?;</code></pre>
<h4 id="downloading-files"><a class="header" href="#downloading-files">Downloading Files</a></h4>
<pre><code class="language-rust ignore">use netmito::config::client::GroupAttachmentDownloadArgs;

let args = GroupAttachmentDownloadArgs {
    group_name: Some("my-group".to_string()),
    attachment_key: "datasets/experiment-1.tar.gz".to_string(),
    output_path: Some("./downloaded-dataset.tar.gz".to_string()),
    ..Default::default()
};

client.group_attachment_download(args).await?;</code></pre>
<h2 id="advanced-usage"><a class="header" href="#advanced-usage">Advanced Usage</a></h2>
<h3 id="configuration-options"><a class="header" href="#configuration-options">Configuration Options</a></h3>
<pre><code class="language-rust ignore">use netmito::config::ClientConfig;
use url::Url;
use figment::value::magic::RelativePathBuf;

let config = ClientConfig {
    coordinator_addr: Url::parse("https://coordinator.example.com")?,
    credential_path: Some(RelativePathBuf::from("/path/to/credentials")),
    user: Some("api-user".to_string()),
    password: Some("api-password".to_string()),
    retain: true, // Keep existing login state
};</code></pre>
<h3 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h3>
<pre><code class="language-rust ignore">use netmito::error::{Error, ApiError, AuthError};

match client.task_get(task_id).await {
    Ok(task) =&gt; println!("Task found: {:?}", task),
    Err(Error::ApiError(ApiError::NotFound(_))) =&gt; println!("Task not found"),
    Err(Error::ApiError(ApiError::AuthError(AuthError::PermissionDenied))) =&gt; println!("Access denied"),
    Err(e) =&gt; println!("Other error: {}", e),
}</code></pre>
<h3 id="async-patterns"><a class="header" href="#async-patterns">Async Patterns</a></h3>
<pre><code class="language-rust ignore">use futures::future::join_all;

// Submit multiple tasks concurrently
let tasks: Vec&lt;_&gt; = (0..10).map(|i| {
    let mut client = client.clone();
    let args = TaskSubmitArgs {
        command: vec!["sleep".to_string(), i.to_string()],
        ..Default::default()
    };
    async move { client.task_submit(args).await }
}).collect();

let results = join_all(tasks).await;
for result in results {
    match result {
        Ok(task_id) =&gt; println!("Submitted: {}", task_id),
        Err(e) =&gt; println!("Failed: {}", e),
    }
}</code></pre>
<h3 id="real-time-task-monitoring"><a class="header" href="#real-time-task-monitoring">Real-time Task Monitoring</a></h3>
<pre><code class="language-rust ignore">use netmito::client::redis::MitoRedisClient;
use netmito::entity::state::TaskExecState;
use tokio::time::{interval, Duration};

// Set up Redis client for real-time updates
let mut redis_client = client.get_redis_client().await?;

// Poll task status periodically
let mut interval = interval(Duration::from_secs(5));
loop {
    interval.tick().await;

    let task = client.task_get(task_id).await?;
    println!("Task status: {:?}", task.exec_state);

    if matches!(task.exec_state, TaskExecState::Completed | TaskExecState::Failed) {
        break;
    }
}</code></pre>
<h2 id="integration-examples"><a class="header" href="#integration-examples">Integration Examples</a></h2>
<h3 id="cicd-pipeline-integration"><a class="header" href="#cicd-pipeline-integration">CI/CD Pipeline Integration</a></h3>
<pre><code class="language-rust ignore">pub struct MitosisPipeline {
    client: MitoClient,
}

impl MitosisPipeline {
    pub async fn run_test_suite(&amp;mut self, commit_hash: &amp;str) -&gt; Result&lt;bool, Box&lt;dyn std::error::Error&gt;&gt; {
        // Submit test tasks
        let test_args = TaskSubmitArgs {
            command: vec!["cargo".to_string(), "test".to_string(), "--release".to_string()],
            group: Some("ci-runners".to_string()),
            tags: vec!["rust".to_string(), "testing".to_string()],
            labels: vec![format!("commit:{}", commit_hash)],
            terminal: true,
            ..Default::default()
        };

        let task_id = self.client.task_submit(test_args).await?;

        // Wait for completion
        let result = self.wait_for_task(task_id).await?;

        // Download test results
        let artifact_args = TaskArtifactDownloadArgs {
            task_id,
            artifact_type: "std-log".to_string(),
            output_path: Some(format!("test-results-{}.tar.gz", commit_hash)),
            ..Default::default()
        };

        self.client.task_artifact_download(artifact_args).await?;

        Ok(result.exec_state == TaskExecState::Completed)
    }
}</code></pre>
<h3 id="research-computing-workflow"><a class="header" href="#research-computing-workflow">Research Computing Workflow</a></h3>
<pre><code class="language-rust ignore">pub struct ResearchWorkflow {
    client: MitoClient,
    group: String,
}

impl ResearchWorkflow {
    pub async fn run_parameter_sweep(&amp;mut self, parameters: Vec&lt;Vec&lt;String&gt;&gt;) -&gt; Result&lt;Vec&lt;Uuid&gt;, Box&lt;dyn std::error::Error&gt;&gt; {
        let mut task_ids = Vec::new();

        for (i, params) in parameters.into_iter().enumerate() {
            let args = TaskSubmitArgs {
                command: vec!["python3".to_string(), "experiment.py".to_string()],
                env: params.into_iter().map(|p| format!("PARAM_{}", p)).collect(),
                group: Some(self.group.clone()),
                labels: vec![format!("sweep:experiment-{}", i)],
                tags: vec!["gpu".to_string(), "python".to_string()],
                terminal: true,
                ..Default::default()
            };

            let task_id = self.client.task_submit(args).await?;
            task_ids.push(task_id);
        }

        Ok(task_ids)
    }

    pub async fn collect_results(&amp;mut self, task_ids: Vec&lt;Uuid&gt;) -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
        for task_id in task_ids {
            let args = TaskArtifactDownloadArgs {
                task_id,
                artifact_type: "result".to_string(),
                output_path: Some(format!("results/{}.tar.gz", task_id)),
                ..Default::default()
            };

            self.client.task_artifact_download(args).await?;
        }

        Ok(())
    }
}</code></pre>
<h2 id="api-reference"><a class="header" href="#api-reference">API Reference</a></h2>
<p>For complete API documentation, including all available methods, configuration options, and error types, please refer to the <a href="https://docs.rs/netmito">API documentation</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../guide/development.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../http/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../guide/development.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../http/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
